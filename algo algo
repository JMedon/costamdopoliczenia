Dim sredniZyskALL As Double, typeALL As Double, progOne As Double, progTwo As DoublePublic Type Par   min As Double   max As Double   start As Double   end  As DoubleEnd Type      Sub Algo1()   '---------------------------------------------------------------------------------------   ' Method : Algo   ' Author : Jakub Medon   ' Date   : 2016-11-24   ' Purpose: algo sort   ' TODO:  *kazdy plik musi miec daty   '        *dopasowanie cen/stop zwrotu do zmiennej   '        *odfiltrowanie wg daty - wygenerowanie zmiennej   '        *Algosort   '        *dodanie nonstop L/ S do wyniku   '        *wygenerowanie wyniku do pliku   '        *wygenerowanie tasmy kierunkow do pliku   '        *   '---------------------------------------------------------------------------------------   On Error GoTo MojaProce_Error   With Application      .ScreenUpdating = False      .Calculation = xlCalculationManual      .UseSystemSeparators = False      .DecimalSeparator = "."   End With   '-START---------------------------------------------------   '##########################################################   '####################### IMPORT DATA ######################   '##########################################################   Set fs = CreateObject("Scripting.FileSystemObject")   PATCHstr = "C:\Users\medonj\MOJE\model sortowania\In"   ChDir PATCHstr   strplik = Dir(PATCHstr & "\*.csv") '#    Open PATCHstr & "\" & strplik For Input As #3    rozmiarWierszy = 0    Do While Not EOF(3)        Line Input #3, Textline                rozmiarWierszy = rozmiarWierszy + 1    Loop    Close #3        ReDim X(1 To rozmiarWierszy) As Double    ReDim Y(1 To rozmiarWierszy) As Double     ' rozmiarWierszy = countRowsInFile(PATCHstr, strplik, ";", startDate, midDate, startOutDate)            Debug.Print rozmiarWierszy      'wczytanie danych      Open PATCHstr & "\" & strplik For Input As #3      i = 1      Do While Not EOF(3)         Line Input #3, Textline         ArrCells = Split(Textline, ",")            X(i) = Val(ArrCells(0))            Y(i) = Val(ArrCells(1))      '    ! napisac zamiane pustych lub bledow na zero        i = i + 1      Loop      Close #3lewy = LBound(X, 1):    prawy = UBound(X, 1) 'Debug.Print X, YSortowanieDwoch X, Y, lewy, prawy'try = (X(1) > Y(1)) * 1'Debug.Print try   aaa = AlgoSortNow(rozmiarWierszy, X, Y, sredniZyskALL, typeALL, progOne, progTwo)'         kierunekDzien = kierunekFDebug.Print aaa, sredniZyskALL, typeALL, progOne, progTwo   '-END---------------------------------------------------MojaProce_Error:   With Application      .Calculation = xlCalculationAutomatic      .ScreenUpdating = True      .CutCopyMode = False   End WithEnd Sub
