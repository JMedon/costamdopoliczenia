Public Function wynikOutofSample(ByVal ile As Double, ByRef X_Out() As Double, ByRef Y_Out() As Double, ByRef K_nominal() As Double, ByRef K_Sharpe() As Double, ByRef InSampleSharpe As Double, ByRef sredniZysk As Double, ByRef sharpeRatio As Double, ByRef typeALL As Double, ByRef progOne As Double, ByRef progTwo As Double) As DoubleDim OutZysk As DoubleReDim Zysk(1 To ile) As DoubleReDim K_nominal(1 To ile) As DoubleReDim K_Sharpe(1 To ile) As DoubleOutZysk = 0For u = 1 To ile    If typeALL = 1 Then        K_nominal(u) = Sgn(X_Out(u) - progOne)        Zysk(u) = K_nominal(u) * Y_Out(u)    ElseIf typeALL = 2 Then        K_nominal(u) = Sgn(X_Out(u) - progOne) * -1        Zysk(u) = K_nominal(u) * Y_Out(u)    ElseIf typeALL = 3 Then        If X_Out(u) < progOne Then            K_nominal(u) = 1            Zysk(u) = K_nominal(u) * Y_Out(u)        Else            K_nominal(u) = Sgn(X_Out(u) - progTwo)            Zysk(u) = K_nominal(u) * Y_Out(u)        End If    ElseIf typeALL = 4 Then        If X_Out(u) < progOne Then            K_nominal(u) = -1            Zysk(u) = K_nominal(u) * Y_Out(u)        Else            K_nominal(u) = Sgn(X_Out(u) - progTwo) * -1            Zysk(u) = K_nominal(u) * Y_Out(u)        End If    Else        K_nominal(u) = 0        Zysk(u) = 0    End If
